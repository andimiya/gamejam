<h1>Play</h1>
<head>
<style>

    #container {
      border: 1px solid black;
      display: block;
    }
    .row {
      border: 1px solid black;
      float: left;
      width: 600px;
    }
    .cell {
      border: 1px solid black;
      width: 200px;
      height: 200px;
      float: left;
    }
</style>
</head>


<body onload="startGame();">

  <div id="message">Messages will go here</div>

  <div id="container"></div>
  <div class="row" id="row-1"></div>
    <div class="cell" id="cell-0"></div>
    <div class="cell" id="cell-1"></div>
    <div class="cell" id="cell-2"></div>
  <div class="row" id="row-2"></div>
    <div class="cell" id="cell-3"></div>
    <div class="cell" id="cell-4"></div>
    <div class="cell" id="cell-5"></div>
  <div class="row" id="row-3"></div>
    <div class="cell" id="cell-6"></div>
    <div class="cell" id="cell-7"></div>
    <div class="cell" id="cell-8"></div>

  <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
  <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
  <script>
    var socket = io('http://localhost:3000');
      socket.on('chat', function (data) {
        $('#messages').append(data.message);
      })
        // Create socket handler to receive gamestate update from server
        // update sampleMatrix
        // call the setGrid Function
      $('#chatForm').on('submit', (event) => {
        event.preventDefault();
        socket.emit('chat', { message: $('#m').val()})
      });

    function startGame(){
      document.turn = "X";
      setMessage(document.turn + " gets to start");
    }

    function setMessage(msg){
      document.getElementById("message").innerHTML = msg;
    }

    function nextMove(cell) {
      // console.log (cell.innerHTML);
      // if (cell.innerHTML === "") {
        switchTurn();
      //   console.log(document.turn);
      // }
      // else {
      //   setMessage("That square is already used");
      // }
    }

    function switchTurn() {
      if (checkForWinner(document.turn)) {
        setMessage("Congratulations " + document.turn + " You Win!");
      }
      else if (document.turn === "X"){
        document.turn = "0"
        setMessage("Its " + document.turn + "s Turn")
      }
      else {
        document.turn = "X";
        setMessage("Its " + document.turn + "s Turn")
      }
    }

    function checkForWinner(move) {
      var result = false;

      if (
        checkRow(1, 2, 3, move ) ||
        checkRow(4, 5, 6, move ) ||
        checkRow(7, 8, 9, move ) ||
        checkRow(1, 4, 7, move ) ||
        checkRow(2, 5, 8, move ) ||
        checkRow(3, 6, 9, move ) ||
        checkRow(1, 5, 9, move ) ||
        checkRow(3, 5, 7, move ) )
      {
      result = true;
      }
      return result;
    }

    function checkRow(a, b, c, move) {
      var result = false;
      if (
        getBox(a) === move &&
        getBox(b) === move &&
        getBox(c) === move ) {
      result = true;
      }
      return result;
    }

    function getBox(number){
      return document.getElementById("cell-0").innerHTML;
    }

    let storeState = [0,0,0,0,0,0,0,0,0];

    document.getElementById('cell-0').addEventListener('click', (event) => {
      console.log({cell: 0});
      storeState.splice(0, 0, 1);
      event.currentTarget.innerHTML = document.turn;
      console.log(storeState);
      socket.emit('clicked', {cell: 0});
      nextMove(event.currentTarget);
    });

    // function cell0() {
    //   console.log({cell: 0});
    //   document.getElementById('cell-0').innerHTML = document.turn;
    //   storeState.splice(0, 0, 1);
    //   console.log(document.turn);
    //   socket.emit('clicked', {cell: 0});
    //   switchTurn();
    // }

    // function cell1() {
    //   console.log({cell: 1});
    //   document.getElementById('cell-1').innerHTML = document.turn;
    //   storeState.splice(0, 0, 1);
    //   switchTurn();
    //   console.log(storeState);
    //   socket.emit('clicked', {cell: 1});
    // }


    document.getElementById('cell-1').addEventListener('click', (event) => {
      console.log({cell: 1});
      // nextMove(1);
      // innerHTML = "X";
      storeState.splice(0, 0, 1);
      event.currentTarget.innerHTML = document.turn;
      console.log(storeState);
      socket.emit('clicked', {cell: 1});
      nextMove(event.currentTarget);
    });

    document.getElementById('cell-2').addEventListener('click', (event) => {
      console.log({cell: 2});
      // nextMove(1);
      storeState.splice(0, 0, 1);
      event.currentTarget.innerHTML = document.turn;
      console.log(storeState);
      socket.emit('clicked', {cell: 2});
      nextMove(event.currentTarget);
    });

    document.getElementById('cell-3').addEventListener('click', (event) => {
      console.log({cell: 3});
      // nextMove(1);
      storeState.splice(0, 0, 1);
      console.log(storeState);
      socket.emit('clicked', {cell: 3});
    });
    document.getElementById('cell-4').addEventListener('click', (event) => {
      console.log({cell: 4});
      socket.emit('clicked', {cell: 4});
    });
    document.getElementById('cell-5').addEventListener('click', (event) => {
      console.log({cell: 5});
      socket.emit('clicked', {cell: 5});
    });
    document.getElementById('cell-6').addEventListener('click', (event) => {
      console.log({cell: 6});
      socket.emit('clicked', {cell: 6});
    });
    document.getElementById('cell-7').addEventListener('click', (event) => {
      console.log({cell: 7});
      socket.emit('clicked', {cell: 7});
    });
    document.getElementById('cell-8').addEventListener('click', (event) => {
      console.log({cell: 8});
      socket.emit('clicked', {cell: 8});
    });

</script>

{{!-- <div id="grid"></div>

<ul id="messages"></ul>
    <form action="" id="chatForm">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form> --}}